<?xml version="1.0" encoding="UTF-8"?>
<context 
    name="routlt"
    type="AppserverIo\Appserver\Application\Application"
    xmlns="http://www.appserver.io/appserver">

    <classLoaders>
        <classLoader
            name="DgClassLoader"
            interface="ClassLoaderInterface"
            type="AppserverIo\Appserver\Core\DgClassLoader"
            factory="AppserverIo\Appserver\Core\DgClassLoaderFactory">
            <params>
                <param name="environment" type="string">production</param>
                <param name="enforcementLevel" type="integer">7</param>
                <param name="typeSafety" type="boolean">1</param>
                <param name="processing" type="string">exception</param>
            </params>
            <directories>
                <directory enforced="true">/common/classes</directory>
                <directory enforced="true">/WEB-INF/classes</directory>
                <directory enforced="true">/META-INF/classes</directory>
            </directories>
        </classLoader>
    </classLoaders>

    <managers>
        <manager name="AuthenticationManagerInterface" type="AppserverIo\Appserver\ServletEngine\Authentication\StandardAuthenticationManager" factory="AppserverIo\Appserver\ServletEngine\Authentication\StandardAuthenticationManagerFactory">
            <securityDomains>
                <securityDomain name="api-realm">
                    <authConfig>
                        <loginModules>
                            <!-- loginModule type="AppserverIo\Appserver\ServletEngine\Authentication\LoginModule\HtpasswdFile" flag="required">
                                <params>
                                    <param name="filename" type="string">WEB-INF/htpasswd</param>
                                    <param name="password-stacking" type="string">useFirstPass</param>
                                </params>
                            </loginModule -->
                            <loginModule type="AppserverIo\Appserver\ServletEngine\Authentication\LoginModules\DatabasePDOLoginModule" flag="required">
                                <params>
                                    <param name="lookupName" type="string">php:env/combined-appserver/ds/appserver.io-example-application</param>
                                    <param name="principalsQuery" type="string">select password from user where username = ?</param>
                                    <param name="rolesQuery" type="string">select r.name, from role r inner join user p on r.user_id_fk = p.user_id where p.username = ?</param>
                                    <param name="hashAlgorithm" type="string">SHA-512</param>
                                    <param name="hashEncoding" type="string">hex</param>
                                    <param name="password-stacking" type="string">useFirstPass</param>
                                </params>
                            </loginModule>
                        </loginModules>
                    </authConfig>
                </securityDomain>
            </securityDomains>
        </manager>
    </managers>

</context>